int pj = permutation[j];
double dpj = diag[pj];
if (dpj != 0) {
for (int k = j + 1; k < lmDiag.length; ++k) {
dxNorm = Math.sqrt(dxNorm);
double previousFP = fp;
fp = dxNorm - delta;

// if the function is small enough, accept the current value

