double thetaA = thetaRotated(phi, thetaB);

double lambda = lambdaScaling(phi, thetaB);

if(thetaA < 0)

