static double logZ(int N, double[] g, double beta)
{
// m = max {e^(g - beta E)}
double m = 0;
for (int E = -2 * N; E <= 2 * N; E += 4)
return Math.log(s) + m;
}

static double heatCapacity(int N, double[] g, double beta)
{
double logZ = logZ(N, g, beta);

