for (int i = 0; i < data.length; i++)
{
val = data[i];
if (val < min)
for (int i = 0; i < keyPoints.length; i++)
keyPoints[i] = r.nextDouble() * 2 - 1;

if (wrapEnds)
{
keyPoints[keyPoints.length - 1] = keyPoints[2];

