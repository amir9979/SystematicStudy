long p3 = p*p*p;
for (long q = 1; q < p; ++q) {
if ((4*n2)%q != 0) continue;

long q2 = q*q;
long d = (q2 + (4*n2)/q*p3);

