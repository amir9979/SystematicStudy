import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.atomic.AtomicBoolean;

import com.google.common.base.Function;
queue.completeRecovery();

_recoveringQueues.remove(queue);
if (_recoveringQueues.isEmpty() &amp;&amp; _recoveryComplete.compareAndSet(false, true))

