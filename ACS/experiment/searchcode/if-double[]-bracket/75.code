double factor = tooClose ? 10 : 0.1;
for (int i = 0; i < 10; i++) {
if (f1 > f2)
return optimize(bracket(x1, f1, x2, f2));
public Pair<Double,Double> optimize(double[] bracket) {
double x0 = bracket[0];
double xm = bracket[1];
double x3 = bracket[2];
double x1, x2;
if (abs(xm-x0) < abs(xm-x3)) {

