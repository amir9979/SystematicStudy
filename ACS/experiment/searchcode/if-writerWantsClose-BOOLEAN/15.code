if (writerSentClose) throw new IllegalStateException(&quot;closed&quot;);
if (writerWantsClose) throw new IllegalStateException(&quot;must call close()&quot;);

