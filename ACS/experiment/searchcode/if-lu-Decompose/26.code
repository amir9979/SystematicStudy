int numCols = LU.numRows < LU.numCols ? LU.numRows : LU.numCols;

if( lower == null ) {
int numRows = LU.numRows < LU.numCols ? LU.numRows : LU.numCols;
int numCols = LU.numCols;

if( upper == null ) {
upper = new DenseMatrix64F(numRows, numCols);

