public static double betai(final double a, final double b, final double x) {
double bt;
if (a <= 0.0 || b <= 0.0) throw new IllegalArgumentException(&quot;Bad a or b in routine betai&quot;);
w = (x*sqrt(al+h)/h)-(1./(2.*b-1)-1./(2.*a-1.))*(al+5./6.-2./(3.*h));
x = a/(a+b*exp(2.*w));
} else {
double lna = log(a/(a+b)), lnb = log(b/(a+b));

