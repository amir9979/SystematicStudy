double lastDirection = 0;
double direction = 0;
while(delta > 1e-6) {
currentcdf = normcdf(z);
direction = 1;
}
z += delta * direction;
if (direction != lastDirection) {

