double dx2=x-midx;
dx2=dx2*dx2;
double t=arr[base+x];
if(dx2+dy2<=extentX*extentX)
if(t<minIntensity)
double dx2=x-midx;
double t;

//For unweighted circle
dx2=dx2*dx2;
if(dx2+dy2<=extent*extent)

