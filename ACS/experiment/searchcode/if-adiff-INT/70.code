List<T> prepatch_list = list1;
List<T> postpatch_list = list1;
for (Diff<T> aDiff : diffs)
{
if (patch.diffs.isEmpty() &amp;&amp; aDiff.operation != Diff.Operation.EQUAL)
case EQUAL:
if (aDiff.list.size() <= 2 * Patch_Margin
&amp;&amp; !patch.diffs.isEmpty() &amp;&amp; aDiff != diffs.getLast())

