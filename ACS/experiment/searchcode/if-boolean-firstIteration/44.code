final Set<Long> visitedRelationIds = new HashSet<Long>();

new AbstractVisitor() {
boolean firstIteration;

@Override
public void visit(Node n) {
if (!visitedNodeIds.add(n.getUniqueId()))

