Graphics2D g = (Graphics2D) res.getGraphics();

double unitWidth = width / (double) layer.getXSize();
double unitHeight = height / (double) layer.getYSize();
Color[][] colours = new Color[locations.length][locations[0].length];

if (showColourCoding) {
double colourZoomX = 255.0 / layer.getXSize();

