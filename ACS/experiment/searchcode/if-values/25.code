double onePlusTrace = 1. + values[M00] + values[M11] + values[M22];

Quaternion rotation;
if (onePlusTrace > MathUtil.DOUBLE_ROUNDING_ERROR) {
0.25f * s
);
} else {
if ((values[M00] > values[M11]) &amp; (values[M00] > values[M22])) {

