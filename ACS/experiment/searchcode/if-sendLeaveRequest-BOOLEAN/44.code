// a flag that should be used only for testing
private final boolean sendLeaveRequest;

private final ElectMasterService electMaster;
initialStateSent.set(false);
DiscoveryNodes nodes = nodes();
if (sendLeaveRequest) {
if (nodes.masterNode() == null) {

