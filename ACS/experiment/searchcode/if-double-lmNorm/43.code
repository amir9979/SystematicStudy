int pj = permutation[j];
double dpj = diag[pj];
if (dpj != 0) {
for (int k = j + 1; k < lmDiag.length; ++k) {
// appropriate element in the current row of d
if (lmDiag[k] != 0) {

double sin, cos;

