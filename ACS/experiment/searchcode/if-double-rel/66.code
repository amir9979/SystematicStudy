public static void test(DifferentiableFunction func, double[] x, double relEps, double delInitial, double delMin) {
double[] nextX = a.copy(x);
Pair<Double,double[]> valAndGrad = func.calculate(x);
if (!ok) System.out.printf(&quot;Empirical gradient step-size underflow dim %d, delta %.12f, calculated %.12f, empirical: %.12f\n&quot;, i, delta, grad[i], empDeriv);
}

public static boolean close(double x, double y, double relEps) {
if (Math.abs(x - y) < EPS) return true;

