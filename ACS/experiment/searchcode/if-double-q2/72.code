int q1 = p1+x/2-1, q2 = p2+(x+1)/2-1;
if (q1 > r1) {
q1 = r1;
q2 = p2+x-(q1-p1+1)-1;
} else if (q2 > r2) {
q2 = r2;
q1 = p1+x-(q2-p2+1)-1;

