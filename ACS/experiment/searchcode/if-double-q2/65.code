double q2q2 = q2*q2, q2q3 = q2*q3;
double q3q3 = q3*q3;
if(mat==null) {
mat = new double[16];
public final void normalize() {
double norm = q0*q0+q1*q1+q2*q2+q3*q3;
if(norm==1) {

