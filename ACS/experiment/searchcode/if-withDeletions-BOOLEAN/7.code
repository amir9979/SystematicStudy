assertEquals(shouldCollect, collected.get());
}

private void countTestCase(boolean withDeletions) throws Exception {
for (int i = 0; i < numDocs; ++i) {
Document doc = new Document();
if (randomBoolean()) {

