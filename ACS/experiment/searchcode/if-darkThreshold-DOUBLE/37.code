MultivariateFunction f = new MultivariateFunction() {
public double value(double[] x) {
if (x.length != 2) {
final double darkFraction = 0.5;
final double darkThreshold = 1e-2;
final double background = Double.NaN;
final double exponent = 1.1;

