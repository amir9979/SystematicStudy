int length = highindex - lowindex + 1;
int i, j, increment;
i = j = increment = 1;

while (true) {
if (increment * 2 - 1 < length)
increment *= 2;
else
break;
}

increment--;

if (!reversed) {

