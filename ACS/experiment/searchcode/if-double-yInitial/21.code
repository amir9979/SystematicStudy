Function<Double, Double> stepFunc = (x) -> {
if(x < densityCentre - densityWidth) {
//and equal height on both sides, left being higher than right.
Function<Double, Double> analyticalIntegral = (x) -> {
if (x < densityCentre - densityWidth) {

