public static final String NAME = &quot;shards_limit&quot;;

private volatile int clusterShardLimit;

/**
* Controls the maximum number of shards per index on a single Elasticsearch
// Capture the limit here in case it changes during this method&#39;s
// execution
final int clusterShardLimit = this.clusterShardLimit;

if (indexShardLimit <= 0 &amp;&amp; clusterShardLimit <= 0) {

