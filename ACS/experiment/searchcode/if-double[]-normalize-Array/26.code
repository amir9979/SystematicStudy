public static ArrayRealVector gradient(DiffableFunction f, Scalar[] parameters, ArrayRealVector result) {
if (result == null)
result = new ArrayRealVector(parameters.length);

double d[] = result.getDataRef();

