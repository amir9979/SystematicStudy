for (int blockRow = edgeSize; blockRow >= -edgeSize; blockRow--)
{
for (int blockCol = edgeSize; blockCol >= -edgeSize; blockCol--)
double noramlizerBlue = 0;

// this is where the magic happens
for (int blockRow = sigma - 1; blockRow >= -(sigma - 1); blockRow--)

