this.formatter = formatter;
if (valuesSource != null) {
final BigArrays bigArrays = context.bigArrays();
return valuesSource != null &amp;&amp; valuesSource.needsScores();
}

@Override
public double metric(long owningBucketOrd) {
if (valuesSource == null || owningBucketOrd >= sums.size()) {

