if (ivz <= 0) throw new IllegalStateException(&quot;Aspect ratio in z-dimension less than or equal to 0&quot;);
if (resample) {
double vmin = (ivx < ivy) ? ivx : ivy;
ci.y = FMath.round((ipc.y + dx*bwd.ayx + dy*bwd.ayy + dz*bwd.ayz + bwd.ayt)/ivy);
if (ci.x < 0 || ci.x > ipmax.x ||

