Dataset bds = b instanceof Dataset ? (Dataset) b : DatasetFactory.createFromObject(b);
boolean useLong = bds.elementClass().equals(Long.class);
if (bds.getSize() == 1) {

