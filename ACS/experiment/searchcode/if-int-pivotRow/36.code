for (int col = 0; col < m.N; col++) {
if (pivotRow < m.M) {
int switchTo = m.M - 1;
while (pivotRow != switchTo &amp;&amp;
m.ROWS[pivotRow][col].equals(new ComplexNumber(0))) {
public Matrix ref() {
Matrix m = copy();
int pivotRow = 0;
for (int col = 0; col < m.N; col++) {
if (pivotRow < m.M) {

