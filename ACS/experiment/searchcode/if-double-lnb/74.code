// u = (log_p) ? log_u : exp(log_u); // =: M in (9.2) of {reference above}
double u = Math.exp(logU);

if (logU == Double.NEGATIVE_INFINITY) {
double s = 0.0;
if (n > 1) {
double coef = b - n;
for (int i = 1; i <= nm1; ++i) {

