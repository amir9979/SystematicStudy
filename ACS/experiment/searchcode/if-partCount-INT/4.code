public static String[] parseLine(String line, int partCount)
{
String[] parts = new String[partCount];
for (int p = 0; p < partCount; ++ p) parts[p] = &quot;&quot;;

int part = 0, i = 0;
boolean inPart = false, escaped = false;

