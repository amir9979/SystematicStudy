public static double ln_factorial(long n) {
double prod;

if (n > 15) prod = 0.5 * Math.log((double )(2 * n * Math.PI)) + n * Math.log((double )n) - n;
else        prod = Math.log((double )factorial(n));

return prod;

