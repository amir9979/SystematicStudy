public static double[][] lag(double[] x, int maxLag) {

if (maxLag < 1) {
throw new IllegalArgumentException(&quot;maxLag should be greater than 0&quot;);
}
if (x == null || maxLag > x.length) {

